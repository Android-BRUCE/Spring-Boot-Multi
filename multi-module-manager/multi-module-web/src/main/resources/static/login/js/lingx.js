var Lingx=Lingx||{};Lingx.html=Lingx.html||{};Lingx.html.template=Lingx.html.template||{};Lingx.html.template.message="";Lingx.PANEL_HEIGHT=60;Lingx.MAX_HEIGHT=500;Lingx.getRootWindow=function(a){a=a||window;return a.isRoot&&a.isRoot()?a:Lingx.getRootWindow(a.parent.window)};Lingx.getRandomString=function(a){for(var c="",b=0;b<a;b++)c+="1234567890qwertyuiopasdfghjklzxcvbnmASDFGHJKLQWERTYUIOPZXCVBNM".charAt(62*Math.random());return c};
Lingx.post=function(a,c,b){Ext.Ajax.request({url:a,params:c,success:function(a){a=Ext.JSON.decode(a.responseText);b.call(this,a)}})};Lingx.getTimeByDateObject=function(a){return a.getFullYear()+""+Lingx.add0(a.getMonth()+1,2)+""+Lingx.add0(a.getDate(),2)+Lingx.add0(a.getHours(),2)+Lingx.add0(a.getMinutes(),2)+Lingx.add0(a.getSeconds(),2)};Lingx.getSTimeByDateObject=function(a){return a.getFullYear()+""+Lingx.add0(a.getMonth()+1,2)+""+Lingx.add0(a.getDate(),2)+"000000"};
Lingx.getETimeByDateObject=function(a){return a.getFullYear()+""+Lingx.add0(a.getMonth()+1,2)+""+Lingx.add0(a.getDate(),2)+"235959"};Lingx.formatTime14=function(a){return a.substring(0,4)+"-"+a.substring(4,6)+"-"+a.substring(6,8)+" "+a.substring(8,10)+":"+a.substring(10,12)+":"+a.substring(12,14)};Lingx.formatTime8=function(a){return a.substring(0,4)+"-"+a.substring(4,6)+"-"+a.substring(6,8)};Lingx.formatTimeTS=function(a){var c=new Date;c.setTime(a);return c.format("yyyy-MM-dd hh:mm:ss")};
Lingx.toTime14=function(a){return a.format("yyyy-MM-dd hh:mm:ss").replace(/[^0-9]/ig,"")};Lingx.add0=function(a,c){a=""+a;for(var b=a.length;b<c;b++)a="0"+a;return a};
Lingx.playAlarm=function(){var a;a=Ext.isIE?'<embed id="myaudio" src="images/1311.mp3" width="0" height="0" hidden="true" autostart="1" loop="1" align="middle" showdisplay="0" showcontrols="1" showpositioncontrols="1" showselectioncontrols="0" showtracker="1" moviewindowsize="0" fullscreenmode="0" moviewindowwidth="0" moviewindowheight="0" autorewind="1" playcount="1" selectionstart="0" appearance="1" borderstyle="0" filename="1311.mp3" displaymode="0"></embed>':'<audio id="myaudio" src="images/1311.mp3" controls="controls" loop="true" hidden="true" autoplay="true" ></audio>';
document.getElementById("alarmAudio").innerHTML=a};Lingx.urlAddParams=function(a,c){-1==a.indexOf("?")&&(a+="?_1=1");if(c)for(var b in c)a=a+"&"+b+"="+c[b];return a};
Lingx.fieldPushItems=function(a,c,b,e){var d={etype:a.refEntity,fieldLabel:a.isNotNull?"<span style='color:red;'>*</span>"+a.name:a.name,name:a.code,xtype:a.inputType,value:a.value,params:{extparam:extparam},width:14*a.length,minWidth:100,maxWidth:400};c.toField&&"id"!=c.toField||!e[a.code]||(d.xtype="hidden",d.value=e[a.code]);c.prompt&&b.push({fieldLabel:"\u63d0\u793a",name:"",value:json.prompt,xtype:"displayfield"});switch(a.inputType){case "hidden":Ext.isObject(a.value)&&(a.value=a.value.value);
b.push({name:a.code,value:a.value,xtype:"hidden"});break;case "displayfield":if(Ext.isObject(a.value))if(a.value.exists)if(alert(a.value.value),-1==a.value.value.indexOf(","))a.value="<a href='javascript:;' onclick='openViewWindow(\""+a.value.etype+'","'+a.value.ename+'","'+a.value.id+"\")'>"+a.value.text+"</a>";else{c=a.value.value.split(",");e=a.value.text.split(",");for(var f=a.value.id.split(","),h="",g=0;g<c.length;g++)h+="<a href='javascript:;' onclick='openViewWindow(\""+a.value.etype+'","'+
a.value.ename+'","'+f[g]+"\")'>"+e[g]+"</a>";a.value=h}else a.value=a.value.text;b.push({name:a.code,value:a.value,xtype:"hidden"});b.push(d);break;case "datefield":d.format="Y-m-d";b.push(d);break;case "datetimefield":d.format="Y-m-d H:i:s";b.push(d);break;case "textfield":case "password":d.listeners={specialkey:function(a,b){b.getKey()==b.ENTER&&lingxSubmit()}};b.push(d);break;case "radio":case "checkbox":d.store="tlingx_optionitem"==a.refEntity?new Ext.data.Store({proxy:{model:"TextValueModel",
type:"ajax",url:"e?e=tlingx_option&m=items&lgxsn=1&code="+a.inputOptions,reader:{type:"json"}},autoLoad:!1}):new Ext.data.Store({proxy:{model:"TextValueModel",type:"ajax",url:"e?e="+a.refEntity+"&m=combo&lgxsn=1",reader:{type:"json"}},autoLoad:!1});b.push(d);break;case "combobox":d.displayField="text";d.valueField="value";d.store="tlingx_optionitem"==a.refEntity?new Ext.data.Store({proxy:{model:"TextValueModel",type:"ajax",url:"e?e=tlingx_option&m=items&lgxsn=1&code="+a.inputOptions,reader:{type:"json"}},
autoLoad:!0}):new Ext.data.Store({proxy:{model:"TextValueModel",type:"ajax",url:"e?e="+a.refEntity+"&m=combo&lgxsn=1",reader:{type:"json"}},autoLoad:!0});Ext.isObject(d.value)&&(d.value=d.value.value);b.push(d);break;default:b.push(d)}};Lingx.javascriptPasswordEncode=function(a,c){for(var b="",e=0;e<c.length;e++)0<="1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM_".indexOf(c.charAt(e))&&(b+=c.charAt(e));c=b;a=hex_md5(a);c=hex_md5(c);return hex_md5(a+c)};
function methodWindow(a,c,b){var e="",d;for(d in params)e=e+"&"+d+"="+params[d];if("JSON"==b.type)if(b.currentRow)if((d=Ext.getCmp("datas").getSelectionModel().getSelection())&&0<d.length){var f=d[0].data.id;Lingx.post("d",{c:"method_script",e:c.code,m:b.code,id:f},function(d){d.ret?0==b.fields.list.length?b.confirm?confirm(b.confirm)&&Lingx.post("e?e="+c.code+"&m="+b.code+"&"+(b.toField?b.toField:"id")+"="+f+e,{lgxsn:1},function(a){lgxInfo(a.message);reloadGrid()}):Lingx.post("e?e="+c.code+"&m="+
b.code+"&"+(b.toField?b.toField:"id")+"="+f+e,{lgxsn:1},function(a){lgxInfo(a.message);reloadGrid()}):openWindow(c.name+"-"+a.text,"e?e="+c.code+"&m="+b.code+"&"+(b.toField?b.toField:"id")+"="+f+e,b.winStyle):lgxInfo(d.msg||"\u4e0d\u53ef\u64cd\u4f5c")})}else lgxInfo("\u8bf7\u9009\u62e9\u8981\u64cd\u4f5c\u7684\u8bb0\u5f55");else 0==b.fields.list.length?b.confirm?confirm(b.confirm)&&Lingx.post("e?e="+c.code+"&m="+b.code+e,{lgxsn:1},function(a){lgxInfo(a.message)}):Lingx.post("e?e="+c.code+"&m="+b.code+
e,{lgxsn:1},function(a){lgxInfo(a.message)}):openWindow(c.name+"-"+a.text,"e?e="+c.code+"&m="+b.code+e,b.winStyle);else"JSP"==b.type?b.currentRow?(d=Ext.getCmp("datas").getSelectionModel().getSelection())&&0<d.length?(f=d[0].data.id,openWindow(c.name+"-"+a.text,"e?e="+c.code+"&m="+b.code+"&id="+f+e,b.winStyle)):lgxInfo("\u8bf7\u9009\u62e9\u8981\u64cd\u4f5c\u7684\u8bb0\u5f55"):openWindow(c.name+"-"+a.text,"e?e="+c.code+"&m="+b.code+e,b.winStyle):"JAVASCRIPT"==b.type?b.currentRow?(d=Ext.getCmp("datas").getSelectionModel().getSelection())&&
0<d.length?(f=d[0].data.id,Lingx.post("e?e="+c.code+"&m="+b.code+"&id="+f+e,{},function(a){eval(a.javascript)})):lgxInfo("\u8bf7\u9009\u62e9\u8981\u64cd\u4f5c\u7684\u8bb0\u5f55"):Lingx.post("e?e="+c.code+"&m="+b.code+e,{},function(a){eval(a.javascript)}):"URL"==b.type?b.currentRow?(d=Ext.getCmp("datas").getSelectionModel().getSelection())&&0<d.length?(f=d[0].data.id,openWindow(a.text,"e?e="+c.code+"&m="+b.code+"&id="+f+e,b.winStyle)):lgxInfo("\u8bf7\u9009\u62e9\u8981\u64cd\u4f5c\u7684\u8bb0\u5f55"):
Lingx.post("e?e="+c.code+"&m="+b.code+e,{},function(c){openWindow(a.text,c.url,b.winStyle)}):"WINDOW"==b.type&&(b.currentRow?(d=Ext.getCmp("datas").getSelectionModel().getSelection())&&0<d.length?(f=d[0].data.id,Lingx.post("e?e="+c.code+"&m="+b.code+"&id="+f+e,{},function(a){window.open(a.url)})):lgxInfo("\u8bf7\u9009\u62e9\u8981\u64cd\u4f5c\u7684\u8bb0\u5f55"):Lingx.post("e?e="+c.code+"&m="+b.code+e,{},function(a){window.open(a.url)}))}
function callbackFormSubmit(a,c){isExe=!1;c.result.message&&lgxInfo(c.result.message);if(1==c.result.code)getFromWindow(fromPageId)&&getFromWindow(fromPageId).reloadGrid&&getFromWindow(fromPageId).reloadGrid(),closeWindow();else if(a=c.result,a.messages)for(c=0;c<a.messages.length;c++)lgxInfo(a.messages[c])}String.prototype.format=function(a){return this.replace(/{([^{}]+)}/gm,function(c,b){return a[b]})};
String.prototype.getBytes=function(){var a=this.match(/[^x00-xff]/ig);return this.length+(null==a?0:a.length)};